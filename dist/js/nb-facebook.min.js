/*
 * nb-facebook
 * https://github.com/netbek/nb-facebook
 *
 * @author Hein Bekker <hein@netbek.co.za>
 * @copyright (c) 2015 Hein Bekker
 * @license http://www.gnu.org/licenses/agpl-3.0.txt AGPLv3
 */
!function(a,b,c){"use strict";function d(){var a={appId:c,version:"v2.2",cookie:!1,status:!1,xfbml:!1,frictionlessRequests:!1,hideFlashCallback:null,locale:"en_US",canvas:{width:c,height:c},trackEvents:{}};return{set:function(b){_.merge(a,b)},$get:function(){return a}}}function e(c,d,e,f,g,h){var i,j=this,k={initialized:!1,ready:!1};this.init=function(){if(!k.initialized){k.initialized=!0,i=e.defer(),d.fbAsyncInit=function(){a.FB.init({appId:g.appId,version:g.version,cookie:g.cookie,status:g.status,xfbml:g.xfbml,frictionlessRequests:g.frictionlessRequests,hideFlashCallback:g.hideFlashCallback}),b.isDefined(g.canvas.width)&&b.isDefined(g.canvas.height)&&a.FB.Canvas.setSize({width:g.canvas.width,height:g.canvas.height}),b.forEach(g.trackEvents,function(b,c){a.FB.Event.subscribe(c,function(a){h.trackSocial("facebook",b,a)})}),k.ready=!0,i.resolve(a.FB)};var c="fb-root",f=document.getElementById(c);f||(f=document.createElement("div"),f.id=c,document.body.insertBefore(f,document.body.childNodes[0])),c="facebook-jssdk";var j=document.getElementById(c);if(j);else{var l="//connect.facebook.net/"+g.locale+"/sdk.js";j=document.createElement("script"),j.id=c,j.async=!0,j.src=l;var m=document.getElementsByTagName("script")[0];m.parentNode.insertBefore(j,m)}}return i.promise},this.login=function(b){return j.init().then(function(){var c=e.defer();return a.FB.login(function(a){a&&!a.error&&a.authResponse?c.resolve(a):c.reject(a)},b),c.promise})},this.api=function(b,c,d){return j.init().then(function(){var f=e.defer();return a.FB.api(b,c,d,function(a){!a||a.error?f.reject(a):f.resolve(a)},d),f.promise})},this.ui=function(b){return j.init().then(function(){var c=e.defer();return a.FB.ui(b,function(a){!a||a.error?c.reject(a):c.resolve(a)}),c.promise})},this.canvasSetSize=function(c,d){return j.init().then(function(){var f,g=e.defer();return b.isDefined(c)&&b.isDefined(d)&&(f={width:c,height:d}),a.FB.Canvas.setSize(f),g.resolve(!0),g.promise})}}b.module("nb.facebook",["nb.analytics"]).provider("nbFacebookConfig",d).service("nbFacebook",e),e.$inject=["$rootScope","$window","$q","$timeout","nbFacebookConfig","nbAnalytics"]}(window,window.angular);